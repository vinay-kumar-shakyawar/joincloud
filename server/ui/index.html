<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JoinCloud</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <img class="brand-logo" src="/logo.png" alt="JoinCloud" />
        <span>JoinCloud</span>
      </div>
      <div class="status" id="node-status">
        <div class="heartbeat" id="heartbeat">
          <span class="heartbeat-icon" id="heartbeat-indicator" title="Checking connectivity" aria-label="Connectivity status">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41.81 4.5 2.09C12.09 4.81 13.76 4 15.5 4 18 4 20 6 20 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
            </svg>
          </span>
          <span class="heartbeat-label">Heartbeat</span>
          <span class="heartbeat-note" id="heartbeat-note"></span>
        </div>
        <span class="status-indicator" id="status-indicator" aria-hidden="true"></span>
        <span class="status-text" id="status-text">Status: --</span>
        <button class="button secondary small status-stop hidden" id="stop-server" type="button">Stop</button>
      </div>
    </header>

    <main class="layout">
      <aside class="sidebar">
        <button class="nav-button active" data-section="home">Home</button>
        <button class="nav-button" data-section="files">Files</button>
        <button class="nav-button" data-section="shares">Shares</button>
        <button class="nav-button" data-section="messages">
          Messages
          <span class="nav-badge hidden" id="messages-badge">0</span>
        </button>
        <button class="nav-button" data-section="logs">Logs</button>
        <button class="nav-button" data-section="settings">Settings</button>
        <button class="nav-button" data-section="network">Network</button>
      </aside>

      <div class="content">
      <section class="card section" data-section="home">
        <h2>Home</h2>
        <div class="row">
          <div>
            <div class="label">Storage</div>
            <div class="value" id="storage-label">Local storage</div>
          </div>
          <div>
            <div class="label">WebDAV Mount</div>
            <div class="value mono" id="owner-mount">--</div>
          </div>
        </div>
        <div class="row" style="margin-top:12px">
          <button class="button secondary" id="open-storage">Open Storage Folder</button>
        </div>
        <div class="row space-between" style="margin-top:16px">
          <div>
            <div class="label">Public Access</div>
            <div class="value" id="public-status">Unavailable</div>
            <div class="value mono" id="public-url">--</div>
            <div class="value" id="public-reason"></div>
          </div>
          <div class="row">
            <button class="button" id="toggle-public">Enable Public Sharing</button>
            <button class="button secondary" id="retry-public">Retry</button>
            <button class="button secondary" id="switch-lan">Switch to LAN-only</button>
          </div>
        </div>
      </section>

      <section class="card section" data-section="files">
        <div class="row space-between">
          <h2>File Browser</h2>
          <div class="row">
            <button class="button" id="upload-button" type="button">Upload Files</button>
            <input id="upload-input" type="file" multiple hidden />
            <button class="button secondary" id="back-button">Back</button>
            <button class="button secondary" id="refresh-files">Refresh</button>
          </div>
        </div>
        <div class="drop-zone" id="drop-zone">Drag & drop files here</div>
        <div class="breadcrumbs" id="breadcrumbs"></div>
        <div class="file-list" id="file-list"></div>
      </section>

      <section class="card section" data-section="shares">
        <div class="row space-between">
          <h2>Active Shares</h2>
          <button class="button secondary" id="refresh-shares">Refresh</button>
        </div>
        <div class="share-list" id="share-list"></div>
      </section>

      <section class="card section" data-section="messages">
        <div class="row space-between">
          <h2>Messages</h2>
          <div class="value message-status" id="messages-status">Support thread</div>
        </div>
        <div class="message-thread" id="message-thread"></div>
        <div class="message-composer">
          <textarea class="input message-input" id="message-input" rows="2" placeholder="Type a message"></textarea>
          <button class="button" id="message-send" type="button">Send</button>
        </div>
      </section>
      
      <section class="card section" data-section="logs">
        <div class="row space-between">
          <h2>Logs</h2>
          <button class="button secondary" id="refresh-logs">Refresh</button>
        </div>
        <div class="log-list" id="log-list"></div>
      </section>

      <section class="card section" data-section="settings">
        <h2>Settings</h2>
        <div class="row space-between">
          <div>
            <div class="label">Operational Telemetry</div>
            <div class="value">Anonymous, aggregated usage metrics</div>
          </div>
          <label class="toggle">
            <input type="checkbox" id="telemetry-toggle" />
            <span>Enabled</span>
          </label>
        </div>
        <div class="row" style="margin-top:12px">
          <a class="link" href="/privacy" target="_blank" rel="noreferrer">View Privacy Policy</a>
        </div>
        <div class="row" style="margin-top:24px">
          <div style="flex:1">
            <div class="label">Display Name</div>
            <input class="input" id="network-name" maxlength="32" />
          </div>
          <button class="button secondary" id="save-network-name">Save</button>
        </div>
        <div class="row space-between" style="margin-top:16px">
          <div>
            <div class="label">Network Visibility</div>
            <div class="value">Allow other JoinCloud users on this network to see you</div>
          </div>
          <label class="toggle">
            <input type="checkbox" id="network-visibility" />
            <span>Enabled</span>
          </label>
        </div>
        <div class="row" style="margin-top:8px">
          <div class="value">
            What is shared on the network? Only your chosen display name and online status are visible to other JoinCloud users on the same network. No files, device details, or identifiers are ever shared automatically.
          </div>
        </div>

        <!-- Task 1: System Information -->
        <div class="divider"></div>
        <h3>System Information</h3>
        <div class="info-grid" id="system-info">
          <div class="info-row">
            <div class="label">User ID</div>
            <div class="value mono" id="sys-user-id">--</div>
            <button class="button ghost small" id="copy-user-id" title="Copy">ðŸ“‹</button>
          </div>
          <div class="info-row">
            <div class="label">Device UUID</div>
            <div class="value mono" id="sys-device-uuid">--</div>
            <button class="button ghost small" id="copy-device-uuid" title="Copy">ðŸ“‹</button>
          </div>
          <div class="info-row">
            <div class="label">Device / OS</div>
            <div class="value" id="sys-os">--</div>
          </div>
          <div class="info-row">
            <div class="label">Architecture</div>
            <div class="value" id="sys-arch">--</div>
          </div>
          <div class="info-row">
            <div class="label">App Version</div>
            <div class="value" id="sys-version">--</div>
          </div>
          <div class="info-row">
            <div class="label">Backend Status</div>
            <div class="value" id="sys-status">--</div>
          </div>
        </div>
      </section>

      <section class="card section" data-section="network">
        <div class="row space-between">
          <h2>Network</h2>
          <button class="button secondary" id="refresh-network">Refresh</button>
        </div>
        <!-- Task 4: Network purpose clarification -->
        <div class="network-purpose">
          Devices shown here can receive JoinCloud links instantly on your local network.
        </div>
        <div class="network-list" id="network-list"></div>
      </section>
      </div>
    </main>

    <div class="modal" id="share-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Create Share</h3>
          <button class="button ghost" id="close-modal">âœ•</button>
        </div>
        <div class="modal-body">
          <label class="label">Path</label>
          <input class="input mono" id="share-path" readonly />

          <label class="label">Share Scope</label>
          <div class="radio-group">
            <label><input type="radio" name="share-scope" value="local" checked /> Local</label>
            <label><input type="radio" name="share-scope" value="public" /> Public</label>
          </div>

          <label class="label">Permission</label>
          <select class="input" id="share-permission">
            <option value="read-only">Read-only</option>
            <option value="read-write">Read-write</option>
          </select>

          <label class="label">Expiry</label>
          <select class="input" id="share-ttl">
            <option value="3600000">1 hour</option>
            <option value="21600000">6 hours</option>
            <option value="86400000" selected>24 hours</option>
            <option value="604800000">7 days</option>
            <option value="custom">Custom (minutes)</option>
          </select>
          <input class="input" id="share-ttl-custom" type="number" min="1" placeholder="Enter minutes" />
        </div>
        <div class="modal-actions">
          <button class="button secondary" id="cancel-share">Cancel</button>
          <button class="button" id="create-share">Create Share</button>
        </div>
        <div class="modal-result" id="share-result"></div>
        <button class="button secondary" id="copy-share" style="display:none">Copy Link</button>
      </div>
    </div>

    <script src="/app.js"></script>
  </body>
</html>
